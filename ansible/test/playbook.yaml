---
- name: Test 1Password CLI
  hosts: all
  tasks:
    - name: Setup 1Password and get secret
      shell: |
        export OP_SERVICE_ACCOUNT_TOKEN="{{ op_token }}"
        export TEST_SECRET="op://secrets/WikiJS/Env/Username"
        echo $TEST_SECRET
      register: secret_output
      no_log: true

    - name: Display the secret
      debug:
        msg: "The secret value is: {{ secret_output.stdout }}"
